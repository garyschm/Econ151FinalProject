---
title: "Project Data Cleaning"
output: pdf
date: "1 December"
---
 to-do:
  - implement control data
  - fix the group  data so it isnt added but a weighted average
  - santa fe control

Importing libraries: 
```{r}
library("ngram")
library("tm")
library("tidyverse")
library("dplyr")
library("ggplot2")

```


Importing Datasets: 
```{r}

getwd() 

setwd("/Users/jeffreyedsall/Desktop/ProjectData")

charleston_pre = read.csv( file = "'Charleston Church Shooting.csv")

christchurch_pre = read.csv( file = "'Christchurch.csv")

pittsburgh_pre = read.csv( file = "'Pittsburgh_2.csv")

brown_pre = read.csv( file = "brown10000.csv")

laguna_pre = read.csv( file = "laguna10000.csv")

sandy_pre = read.csv( file = "sandy10000.csv")

santafe_pre = read.csv(file = "santafe10000.csv")

trayvon_pre = read.csv(file = "trayvon10000.csv")

uvalde_pre = read.csv( file = "uvalde10000.csv")
  
charleston_control_pre = read.csv( file = "Charleston Control.csv")

christchurch_control_pre = read.csv( file = "'Christchurch Control.csv")

pittsburgh_control_pre = read.csv( file = "'Pittsburgh control.csv")

brown_control_pre = read.csv( file = "browncontrol10000.csv")

laguna_control_pre = read.csv( file = "lagunacontrol10000.csv")

sandy_control_pre = read.csv( file = "'Sandy Hook Control.csv")

santafe_control_pre = read.csv(file = "'Santa Fe HS Control.csv")

trayvon_control_pre = read.csv(file = "treyvoncontrol10000.csv")

uvalde_control_pre = read.csv( file = "uvaldecontrol10000.csv")

emotion_lexicon = read.csv(file = "Emotions_lexicon.csv")

political_lexicon = read.csv(file = "politicallexiconfinal.csv")

```




ALL-IN-ONE CLEANING FUNCTION: 
```{r}
#before running the function, you need to read in the csv file

tweet_clean = function(df) { 
  
  library("ngram")
  library("tm")
  
  
  df_text = paste( df$Tweet, collapse= "")

  
  
  df_text = concatenate(df_text) %>%
  VectorSource() %>%
  Corpus()
  
  
  df_text = tm_map(df_text, content_transformer(tolower)) 
  df_text = tm_map(df_text, content_transformer(removeNumbers)) 
  df_text = tm_map(df_text, removeWords, stopwords("english")) 
  df_text = tm_map(df_text, content_transformer(removePunctuation)) 
  df_text = tm_map(df_text, content_transformer(stripWhitespace))

  df_string = concatenate (lapply(df_text,"[",1))
  df_unigram = get.phrasetable(ngram(df_string, n=1)) 
  
  return(df_unigram)
  
}

```


Cleaning dataframes
```{r}

brown_post = tweet_clean(brown_pre)

charleston_post = tweet_clean(charleston_pre)

christchurch_post = tweet_clean(christchurch_pre)

laguna_post = tweet_clean(laguna_pre)

pittsburgh_post = tweet_clean(pittsburgh_pre)

sandy_post = tweet_clean(sandy_pre)

santafe_post = tweet_clean(santafe_pre)

trayvon_post = tweet_clean(trayvon_pre)

uvalde_post = tweet_clean(uvalde_pre)


brown_control_post = tweet_clean(brown_control_pre)

charleston_control_post = tweet_clean(charleston_control_pre)

christchurch_control_post = tweet_clean(christchurch_control_pre)

laguna_control_post = tweet_clean(laguna_control_pre)

pittsburgh_control_post = tweet_clean(pittsburgh_control_pre)

sandy_control_post = tweet_clean(sandy_control_pre)

santafe_control_post = tweet_clean(santafe_control_pre)

trayvon_control_post = tweet_clean(trayvon_control_pre)

uvalde_control_post = tweet_clean(uvalde_control_pre)

```

View transformed dataframes
```{r}

brown_post
charleston_post
christchurch_post
laguna_post
pittsburgh_post
sandy_post
santafe_post
trayvon_post 
trayvon_post
uvalde_post

```


ALL-IN-ONE Emotion Quotient Function
```{r}

tweet_emotion_quotient = function(df) { 
  
  label = c("Negative", "Fear", "Disgust", "Anger", "Positive")
  EQs = c(0,0,0,0,0)
  num_rows = nrow(df)
  NEQ = 0
  
  for (i in 1:num_rows){
    if (trimws(df$ngrams[i]) %in% emotion_lexicon$Negative == TRUE){
      EQs[1] = EQs[1] + df$prop[i]
    }
  }
  
  for (i in 1:num_rows){
    if (trimws(df$ngrams[i]) %in% emotion_lexicon$Fear == TRUE){
      EQs[2] = EQs[2] + df$prop[i]
    }
  }
  
  for (i in 1:num_rows){
    if (trimws(df$ngrams[i]) %in% emotion_lexicon$Disgust == TRUE){
      EQs[3] = EQs[3] + df$prop[i]
    }
  }
  
  for (i in 1:num_rows){
    if (trimws(df$ngrams[i]) %in% emotion_lexicon$Anger == TRUE){
      EQs[4] = EQs[4] + df$prop[i]
    }
  }
  
  for (i in 1:num_rows){
    if (trimws(df$ngrams[i]) %in% emotion_lexicon$Positive == TRUE){
      EQs[5] = EQs[5] + df$prop[i]
    }
  }
  return(data.frame(label, EQs))
}
```



Getting  Emotion Quotients 
```{r}
brown_post_EQs = tweet_emotion_quotient(brown_post)
brown_post_NEQ = brown_post_EQs[1,2]
brown_post_FEQ = brown_post_EQs[2,2]
brown_post_DEQ = brown_post_EQs[3,2]
brown_post_AEQ = brown_post_EQs[4,2]
brown_post_PEQ = brown_post_EQs[5,2]

charleston_post_EQs = tweet_emotion_quotient(charleston_post)
charleston_post_NEQ = charleston_post_EQs[1,2]
charleston_post_FEQ = charleston_post_EQs[2,2]
charleston_post_DEQ = charleston_post_EQs[3,2]
charleston_post_AEQ = charleston_post_EQs[4,2]
charleston_post_PEQ = charleston_post_EQs[5,2]

christchurch_post_EQs = tweet_emotion_quotient(christchurch_post)
christchurch_post_NEQ = christchurch_post_EQs[1,2]
christchurch_post_FEQ = christchurch_post_EQs[2,2]
christchurch_post_DEQ = christchurch_post_EQs[3,2]
christchurch_post_AEQ = christchurch_post_EQs[4,2]
christchurch_post_PEQ = christchurch_post_EQs[5,2]

laguna_post_EQs = tweet_emotion_quotient(laguna_post)
laguna_post_NEQ = laguna_post_EQs[1,2]
laguna_post_FEQ = laguna_post_EQs[2,2]
laguna_post_DEQ = laguna_post_EQs[3,2]
laguna_post_AEQ = laguna_post_EQs[4,2]
laguna_post_PEQ = laguna_post_EQs[5,2]

pittsburgh_post_EQs = tweet_emotion_quotient(pittsburgh_post)
pittsburgh_post_NEQ = pittsburgh_post_EQs[1,2]
pittsburgh_post_FEQ = pittsburgh_post_EQs[2,2]
pittsburgh_post_DEQ = pittsburgh_post_EQs[3,2]
pittsburgh_post_AEQ = pittsburgh_post_EQs[4,2]
pittsburgh_post_PEQ = pittsburgh_post_EQs[5,2]

sandy_post_EQs = tweet_emotion_quotient(sandy_post)
sandy_post_NEQ = sandy_post_EQs[1,2]
sandy_post_FEQ = sandy_post_EQs[2,2]
sandy_post_DEQ = sandy_post_EQs[3,2]
sandy_post_AEQ = sandy_post_EQs[4,2]
sandy_post_PEQ = sandy_post_EQs[5,2]

santafe_post_EQs = tweet_emotion_quotient(santafe_post)
santafe_post_NEQ = santafe_post_EQs[1,2]
santafe_post_FEQ = santafe_post_EQs[2,2]
santafe_post_DEQ = santafe_post_EQs[3,2]
santafe_post_AEQ = santafe_post_EQs[4,2]
santafe_post_PEQ = santafe_post_EQs[5,2]

trayvon_post_EQs = tweet_emotion_quotient(trayvon_post)
trayvon_post_NEQ = trayvon_post_EQs[1,2]
trayvon_post_FEQ = trayvon_post_EQs[2,2]
trayvon_post_DEQ = trayvon_post_EQs[3,2]
trayvon_post_AEQ = trayvon_post_EQs[4,2]
trayvon_post_PEQ = trayvon_post_EQs[5,2]

uvalde_post_EQs = tweet_emotion_quotient(uvalde_post)
uvalde_post_NEQ = uvalde_post_EQs[1,2]
uvalde_post_FEQ = uvalde_post_EQs[2,2]
uvalde_post_DEQ = uvalde_post_EQs[3,2]
uvalde_post_AEQ = uvalde_post_EQs[4,2]
uvalde_post_PEQ = uvalde_post_EQs[5,2]

# controls 

brown_control_post_EQs = tweet_emotion_quotient(brown_control_post)
brown_control_post_NEQ = brown_control_post_EQs[1,2]
brown_control_post_FEQ = brown_control_post_EQs[2,2]
brown_control_post_DEQ = brown_control_post_EQs[3,2]
brown_control_post_AEQ = brown_control_post_EQs[4,2]
brown_control_post_PEQ = brown_control_post_EQs[5,2]

charleston_control_post_EQs = tweet_emotion_quotient(charleston_control_post)
charleston_control_post_NEQ = charleston_control_post_EQs[1,2]
charleston_control_post_FEQ = charleston_control_post_EQs[2,2]
charleston_control_post_DEQ = charleston_control_post_EQs[3,2]
charleston_control_post_AEQ = charleston_control_post_EQs[4,2]
charleston_control_post_PEQ = charleston_control_post_EQs[5,2]

christchurch_control_post_EQs = tweet_emotion_quotient(christchurch_control_post)
christchurch_control_post_NEQ = christchurch_control_post_EQs[1,2]
christchurch_control_post_FEQ = christchurch_control_post_EQs[2,2]
christchurch_control_post_DEQ = christchurch_control_post_EQs[3,2]
christchurch_control_post_AEQ = christchurch_control_post_EQs[4,2]
christchurch_control_post_PEQ = christchurch_control_post_EQs[5,2]

laguna_control_post_EQs = tweet_emotion_quotient(laguna_control_post)
laguna_control_post_NEQ = laguna_control_post_EQs[1,2]
laguna_control_post_FEQ = laguna_control_post_EQs[2,2]
laguna_control_post_DEQ = laguna_control_post_EQs[3,2]
laguna_control_post_AEQ = laguna_control_post_EQs[4,2]
laguna_control_post_PEQ = laguna_control_post_EQs[5,2]

pittsburgh_control_post_EQs = tweet_emotion_quotient(pittsburgh_control_post)
pittsburgh_control_post_NEQ = pittsburgh_control_post_EQs[1,2]
pittsburgh_control_post_FEQ = pittsburgh_control_post_EQs[2,2]
pittsburgh_control_post_DEQ = pittsburgh_control_post_EQs[3,2]
pittsburgh_control_post_AEQ = pittsburgh_control_post_EQs[4,2]
pittsburgh_control_post_PEQ = pittsburgh_control_post_EQs[5,2]

sandy_control_post_EQs = tweet_emotion_quotient(sandy_control_post)
sandy_control_post_NEQ = sandy_control_post_EQs[1,2]
sandy_control_post_FEQ = sandy_control_post_EQs[2,2]
sandy_control_post_DEQ = sandy_control_post_EQs[3,2]
sandy_control_post_AEQ = sandy_control_post_EQs[4,2]
sandy_control_post_PEQ = sandy_control_post_EQs[5,2]

santafe_control_post_EQs = tweet_emotion_quotient(santafe_control_post)
santafe_control_post_NEQ = santafe_control_post_EQs[1,2]
santafe_control_post_FEQ = santafe_control_post_EQs[2,2]
santafe_control_post_DEQ = santafe_control_post_EQs[3,2]
santafe_control_post_AEQ = santafe_control_post_EQs[4,2]
santafe_control_post_PEQ = santafe_control_post_EQs[5,2]

trayvon_control_post_EQs = tweet_emotion_quotient(trayvon_control_post)
trayvon_control_post_NEQ = trayvon_control_post_EQs[1,2]
trayvon_control_post_FEQ = trayvon_control_post_EQs[2,2]
trayvon_control_post_DEQ = trayvon_control_post_EQs[3,2]
trayvon_control_post_AEQ = trayvon_control_post_EQs[4,2]
trayvon_control_post_PEQ = trayvon_control_post_EQs[5,2]

uvalde_control_post_EQs = tweet_emotion_quotient(uvalde_control_post)
uvalde_control_post_NEQ = uvalde_control_post_EQs[1,2]
uvalde_control_post_FEQ = uvalde_control_post_EQs[2,2]
uvalde_control_post_DEQ = uvalde_control_post_EQs[3,2]
uvalde_control_post_AEQ = uvalde_control_post_EQs[4,2]
uvalde_control_post_PEQ = uvalde_control_post_EQs[5,2]
```


All-in-one political quotient function
```{r}
tweet_political_quotient = function(df) { 
  
  num_rows = nrow(df)
  PQ = 0
  
  for (i in 1:num_rows){
    if (trimws(df$ngrams[i]) %in% political_lexicon$political_final == TRUE){
      PQ = PQ + df$prop[i]
    }
  }
  
  return(PQ)
}
```


Getting Political Quotient Values for each event 
```{r}
brown_post_PQ = tweet_political_quotient(brown_post)

charleston_post_PQ = tweet_political_quotient(charleston_post)

christchurch_post_PQ = tweet_political_quotient(christchurch_post)

laguna_post_PQ = tweet_political_quotient(laguna_post)

pittsburgh_post_PQ = tweet_political_quotient(pittsburgh_post)

sandy_post_PQ = tweet_political_quotient(sandy_post)

santafe_post_PQ = tweet_political_quotient(santafe_post)

trayvon_post_PQ = tweet_political_quotient(trayvon_post)

uvalde_post_PQ = tweet_political_quotient(uvalde_post)

#control 

brown_control_post_PQ = tweet_political_quotient(brown_control_post)

charleston_control_post_PQ = tweet_political_quotient(charleston_control_post)

christchurch_control_post_PQ = tweet_political_quotient(christchurch_control_post)

laguna_control_post_PQ = tweet_political_quotient(laguna_control_post)

pittsburgh_control_post_PQ = tweet_political_quotient(pittsburgh_control_post)

sandy_control_post_PQ = tweet_political_quotient(sandy_control_post)

santafe_control_post_PQ = tweet_political_quotient(santafe_control_post)

trayvon_control_post_PQ = tweet_political_quotient(trayvon_control_post)

uvalde_control_post_PQ = tweet_political_quotient(uvalde_control_post)
```


Create a dataframe with all the macro data 
```{r}
event = c("Brown", "Charleston", "Christchurch", "Laguna", "Pittsburgh", "Sandy Hook", "Santa Fe", "Trayvon Martin", "Uvalde", "Race-Related", "School-Related", "Religion-Related")

AEQ = c(brown_post_AEQ, charleston_post_AEQ, christchurch_post_AEQ, laguna_post_AEQ, pittsburgh_post_AEQ, sandy_post_AEQ, santafe_post_AEQ, trayvon_post_AEQ, uvalde_post_AEQ, (brown_post_AEQ  * nrow(brown_post) + charleston_post_AEQ  * nrow(charleston_post) + trayvon_post_AEQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_AEQ  * nrow(sandy_post) + uvalde_post_AEQ  * nrow(uvalde_post) + santafe_post_AEQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_AEQ  * nrow(christchurch_post) + laguna_post_AEQ  * nrow(laguna_post) + pittsburgh_post_AEQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

DEQ = c(brown_post_DEQ, charleston_post_DEQ, christchurch_post_DEQ, laguna_post_DEQ, pittsburgh_post_DEQ, sandy_post_DEQ, santafe_post_DEQ, trayvon_post_DEQ, uvalde_post_DEQ, (brown_post_DEQ  * nrow(brown_post) + charleston_post_DEQ  * nrow(charleston_post) + trayvon_post_DEQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_DEQ  * nrow(sandy_post) + uvalde_post_DEQ  * nrow(uvalde_post) + santafe_post_DEQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_DEQ  * nrow(christchurch_post) + laguna_post_DEQ  * nrow(laguna_post) + pittsburgh_post_DEQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

FEQ = c(brown_post_FEQ, charleston_post_FEQ, christchurch_post_FEQ, laguna_post_FEQ, pittsburgh_post_FEQ, sandy_post_FEQ, santafe_post_FEQ, trayvon_post_FEQ, uvalde_post_FEQ, (brown_post_FEQ  * nrow(brown_post) + charleston_post_FEQ  * nrow(charleston_post) + trayvon_post_FEQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_FEQ  * nrow(sandy_post) + uvalde_post_FEQ  * nrow(uvalde_post) + santafe_post_FEQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_FEQ  * nrow(christchurch_post) + laguna_post_FEQ  * nrow(laguna_post) + pittsburgh_post_FEQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

NEQ = c(brown_post_NEQ, charleston_post_NEQ, christchurch_post_NEQ, laguna_post_NEQ, pittsburgh_post_NEQ, sandy_post_NEQ, santafe_post_NEQ, trayvon_post_NEQ, uvalde_post_NEQ, (brown_post_NEQ  * nrow(brown_post) + charleston_post_NEQ  * nrow(charleston_post) + trayvon_post_NEQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_NEQ  * nrow(sandy_post) + uvalde_post_NEQ  * nrow(uvalde_post) + santafe_post_NEQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_NEQ  * nrow(christchurch_post) + laguna_post_NEQ  * nrow(laguna_post) + pittsburgh_post_NEQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

PEQ = c(brown_post_PEQ, charleston_post_PEQ, christchurch_post_PEQ, laguna_post_PEQ, pittsburgh_post_PEQ, sandy_post_PEQ, santafe_post_PEQ, trayvon_post_PEQ, uvalde_post_PEQ, (brown_post_PEQ  * nrow(brown_post) + charleston_post_PEQ  * nrow(charleston_post) + trayvon_post_PEQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_PEQ  * nrow(sandy_post) + uvalde_post_PEQ  * nrow(uvalde_post) + santafe_post_PEQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_PEQ  * nrow(christchurch_post) + laguna_post_PEQ  * nrow(laguna_post) + pittsburgh_post_PEQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

PQ = c(brown_post_PQ, charleston_post_PQ, christchurch_post_PQ, laguna_post_PQ, pittsburgh_post_PQ, sandy_post_PQ, santafe_post_PQ, trayvon_post_PQ, uvalde_post_PQ, (brown_post_PQ  * nrow(brown_post) + charleston_post_PQ  * nrow(charleston_post) + trayvon_post_PQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_PQ  * nrow(sandy_post) + uvalde_post_PQ  * nrow(uvalde_post) + santafe_post_PQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_PQ  * nrow(christchurch_post) + laguna_post_PQ  * nrow(laguna_post) + pittsburgh_post_PQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

AEQ_pct_change = c(brown_post_AEQ_pct_change, charleston_post_AEQ_pct_change, christchurch_post_AEQ_pct_change, laguna_post_AEQ_pct_change, pittsburgh_post_AEQ_pct_change, sandy_post_AEQ_pct_change, santafe_post_AEQ_pct_change, trayvon_post_AEQ_pct_change, uvalde_post_AEQ_pct_change, (brown_post_AEQ_pct_change  * nrow(brown_post) + charleston_post_AEQ_pct_change  * nrow(charleston_post) + trayvon_post_AEQ_pct_change  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_AEQ_pct_change  * nrow(sandy_post) + uvalde_post_AEQ_pct_change  * nrow(uvalde_post) + santafe_post_AEQ_pct_change  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_AEQ_pct_change  * nrow(christchurch_post) + laguna_post_AEQ_pct_change  * nrow(laguna_post) + pittsburgh_post_AEQ_pct_change  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

DEQ_pct_change = c(brown_post_DEQ_pct_change, charleston_post_DEQ_pct_change, christchurch_post_DEQ_pct_change, laguna_post_DEQ_pct_change, pittsburgh_post_DEQ_pct_change, sandy_post_DEQ_pct_change, santafe_post_DEQ_pct_change, trayvon_post_DEQ_pct_change, uvalde_post_DEQ_pct_change, (brown_post_DEQ_pct_change  * nrow(brown_post) + charleston_post_DEQ_pct_change  * nrow(charleston_post) + trayvon_post_DEQ_pct_change  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_DEQ_pct_change  * nrow(sandy_post) + uvalde_post_DEQ_pct_change  * nrow(uvalde_post) + santafe_post_DEQ_pct_change  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_DEQ_pct_change  * nrow(christchurch_post) + laguna_post_DEQ_pct_change  * nrow(laguna_post) + pittsburgh_post_DEQ_pct_change  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

FEQ_pct_change = c(brown_post_FEQ_pct_change, charleston_post_FEQ_pct_change, christchurch_post_FEQ_pct_change, laguna_post_FEQ_pct_change, pittsburgh_post_FEQ_pct_change, sandy_post_FEQ_pct_change, santafe_post_FEQ_pct_change, trayvon_post_FEQ_pct_change, uvalde_post_FEQ_pct_change, (brown_post_FEQ_pct_change  * nrow(brown_post) + charleston_post_FEQ_pct_change  * nrow(charleston_post) + trayvon_post_FEQ_pct_change  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_FEQ_pct_change  * nrow(sandy_post) + uvalde_post_FEQ_pct_change  * nrow(uvalde_post) + santafe_post_FEQ_pct_change  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_FEQ_pct_change  * nrow(christchurch_post) + laguna_post_FEQ_pct_change  * nrow(laguna_post) + pittsburgh_post_FEQ_pct_change  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

NEQ_pct_change = c(brown_post_NEQ_pct_change, charleston_post_NEQ_pct_change, christchurch_post_NEQ_pct_change, laguna_post_NEQ_pct_change, pittsburgh_post_NEQ_pct_change, sandy_post_NEQ_pct_change, santafe_post_NEQ_pct_change, trayvon_post_NEQ_pct_change, uvalde_post_NEQ_pct_change, (brown_post_NEQ_pct_change  * nrow(brown_post) + charleston_post_NEQ_pct_change  * nrow(charleston_post) + trayvon_post_NEQ_pct_change  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_NEQ_pct_change  * nrow(sandy_post) + uvalde_post_NEQ_pct_change  * nrow(uvalde_post) + santafe_post_NEQ_pct_change  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_NEQ_pct_change  * nrow(christchurch_post) + laguna_post_NEQ_pct_change  * nrow(laguna_post) + pittsburgh_post_NEQ_pct_change  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

PEQ_pct_change = c(brown_post_PEQ_pct_change, charleston_post_PEQ_pct_change, christchurch_post_PEQ_pct_change, laguna_post_PEQ_pct_change, pittsburgh_post_PEQ_pct_change, sandy_post_PEQ_pct_change, santafe_post_PEQ_pct_change, trayvon_post_PEQ_pct_change, uvalde_post_PEQ_pct_change, (brown_post_PEQ_pct_change  * nrow(brown_post) + charleston_post_PEQ_pct_change  * nrow(charleston_post) + trayvon_post_PEQ_pct_change  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_PEQ_pct_change  * nrow(sandy_post) + uvalde_post_PEQ_pct_change  * nrow(uvalde_post) + santafe_post_PEQ_pct_change  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_PEQ_pct_change  * nrow(christchurch_post) + laguna_post_PEQ_pct_change  * nrow(laguna_post) + pittsburgh_post_PEQ_pct_change  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

PQ_pct_change = c(brown_post_PQ_pct_change, charleston_post_PQ_pct_change, christchurch_post_PQ_pct_change, laguna_post_PQ_pct_change, pittsburgh_post_PQ_pct_change, sandy_post_PQ_pct_change, santafe_post_PQ_pct_change, trayvon_post_PQ_pct_change, uvalde_post_PQ_pct_change, (brown_post_PQ_pct_change  * nrow(brown_post) + charleston_post_PQ_pct_change  * nrow(charleston_post) + trayvon_post_PQ_pct_change  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_PQ_pct_change  * nrow(sandy_post) + uvalde_post_PQ_pct_change  * nrow(uvalde_post) + santafe_post_PQ_pct_change  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_PQ_pct_change  * nrow(christchurch_post) + laguna_post_PQ_pct_change  * nrow(laguna_post) + pittsburgh_post_PQ_pct_change  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))

macro_df = data.frame(event, AEQ, DEQ, FEQ, NEQ, PEQ, PQ, AEQ_pct_change, DEQ_pct_change, FEQ_pct_change, NEQ_pct_change, PEQ_pct_change, PQ_pct_change)
write.csv(macro_df, "/Users/jeffreyedsall/Desktop/ProjectData/macro_df.csv" )
```


EQ and PQ percent change from control
```{r}
brown_post_AEQ_pct_change = 100 * (brown_post_AEQ - brown_control_post_AEQ) / brown_control_post_AEQ
brown_post_DEQ_pct_change = 100 * (brown_post_DEQ - brown_control_post_DEQ) / brown_control_post_DEQ
brown_post_FEQ_pct_change = 100 * (brown_post_FEQ - brown_control_post_FEQ) / brown_control_post_FEQ
brown_post_NEQ_pct_change = 100 * (brown_post_NEQ - brown_control_post_NEQ) / brown_control_post_NEQ
brown_post_PEQ_pct_change = 100 * (brown_post_PEQ - brown_control_post_PEQ) / brown_control_post_PEQ
brown_post_PQ_pct_change = 100 * (brown_post_PQ - brown_control_post_PQ) / brown_control_post_PQ

charleston_post_AEQ_pct_change = 100 * (charleston_post_AEQ - charleston_control_post_AEQ) / charleston_control_post_AEQ
charleston_post_DEQ_pct_change = 100 * (charleston_post_DEQ - charleston_control_post_DEQ) / charleston_control_post_DEQ
charleston_post_FEQ_pct_change = 100 * (charleston_post_FEQ - charleston_control_post_FEQ) / charleston_control_post_FEQ
charleston_post_NEQ_pct_change = 100 * (charleston_post_NEQ - charleston_control_post_NEQ) / charleston_control_post_NEQ
charleston_post_PEQ_pct_change = 100 * (charleston_post_PEQ - charleston_control_post_PEQ) / charleston_control_post_PEQ
charleston_post_PQ_pct_change = 100 * (charleston_post_PQ - charleston_control_post_PQ) / charleston_control_post_PQ

christchurch_post_AEQ_pct_change = 100 * (christchurch_post_AEQ - christchurch_control_post_AEQ) / christchurch_control_post_AEQ
christchurch_post_DEQ_pct_change = 100 * (christchurch_post_DEQ - christchurch_control_post_DEQ) / christchurch_control_post_DEQ
christchurch_post_FEQ_pct_change = 100 * (christchurch_post_FEQ - christchurch_control_post_FEQ) / christchurch_control_post_FEQ
christchurch_post_NEQ_pct_change = 100 * (christchurch_post_NEQ - christchurch_control_post_NEQ) / christchurch_control_post_NEQ
christchurch_post_PEQ_pct_change = 100 * (christchurch_post_PEQ - christchurch_control_post_PEQ) / christchurch_control_post_PEQ
christchurch_post_PQ_pct_change = 100 * (christchurch_post_PQ - christchurch_control_post_PQ) / christchurch_control_post_PQ

laguna_post_AEQ_pct_change = 100 * (laguna_post_AEQ - laguna_control_post_AEQ) / laguna_control_post_AEQ
laguna_post_DEQ_pct_change = 100 * (laguna_post_DEQ - laguna_control_post_DEQ) / laguna_control_post_DEQ
laguna_post_FEQ_pct_change = 100 * (laguna_post_FEQ - laguna_control_post_FEQ) / laguna_control_post_FEQ
laguna_post_NEQ_pct_change = 100 * (laguna_post_NEQ - laguna_control_post_NEQ) / laguna_control_post_NEQ
laguna_post_PEQ_pct_change = 100 * (laguna_post_PEQ - laguna_control_post_PEQ) / laguna_control_post_PEQ
laguna_post_PQ_pct_change = 100 * (laguna_post_PQ - laguna_control_post_PQ) / laguna_control_post_PQ

pittsburgh_post_AEQ_pct_change = 100 * (pittsburgh_post_AEQ - pittsburgh_control_post_AEQ) / pittsburgh_control_post_AEQ
pittsburgh_post_DEQ_pct_change = 100 * (pittsburgh_post_DEQ - pittsburgh_control_post_DEQ) / pittsburgh_control_post_DEQ
pittsburgh_post_FEQ_pct_change = 100 * (pittsburgh_post_FEQ - pittsburgh_control_post_FEQ) / pittsburgh_control_post_FEQ
pittsburgh_post_NEQ_pct_change = 100 * (pittsburgh_post_NEQ - pittsburgh_control_post_NEQ) / pittsburgh_control_post_NEQ
pittsburgh_post_PEQ_pct_change = 100 * (pittsburgh_post_PEQ - pittsburgh_control_post_PEQ) / pittsburgh_control_post_PEQ
pittsburgh_post_PQ_pct_change = 100 * (pittsburgh_post_PQ - pittsburgh_control_post_PQ) / pittsburgh_control_post_PQ

sandy_post_AEQ_pct_change = 100 * (sandy_post_AEQ - sandy_control_post_AEQ) / sandy_control_post_AEQ
sandy_post_DEQ_pct_change = 100 * (sandy_post_DEQ - sandy_control_post_DEQ) / sandy_control_post_DEQ
sandy_post_FEQ_pct_change = 100 * (sandy_post_FEQ - sandy_control_post_FEQ) / sandy_control_post_FEQ
sandy_post_NEQ_pct_change = 100 * (sandy_post_NEQ - sandy_control_post_NEQ) / sandy_control_post_NEQ
sandy_post_PEQ_pct_change = 100 * (sandy_post_PEQ - sandy_control_post_PEQ) / sandy_control_post_PEQ
sandy_post_PQ_pct_change = 100 * (sandy_post_PQ - sandy_control_post_PQ) / sandy_control_post_PQ

santafe_post_AEQ_pct_change = 100 * (santafe_post_AEQ - santafe_control_post_AEQ) / santafe_control_post_AEQ
santafe_post_DEQ_pct_change = 100 * (santafe_post_DEQ - santafe_control_post_DEQ) / santafe_control_post_DEQ
santafe_post_FEQ_pct_change = 100 * (santafe_post_FEQ - santafe_control_post_FEQ) / santafe_control_post_FEQ
santafe_post_NEQ_pct_change = 100 * (santafe_post_NEQ - santafe_control_post_NEQ) / santafe_control_post_NEQ
santafe_post_PEQ_pct_change = 100 * (santafe_post_PEQ - santafe_control_post_PEQ) / santafe_control_post_PEQ
santafe_post_PQ_pct_change = 100 * (santafe_post_PQ - santafe_control_post_PQ) / santafe_control_post_PQ

trayvon_post_AEQ_pct_change = 100 * (trayvon_post_AEQ - trayvon_control_post_AEQ) / trayvon_control_post_AEQ
trayvon_post_DEQ_pct_change = 100 * (trayvon_post_DEQ - trayvon_control_post_DEQ) / trayvon_control_post_DEQ
trayvon_post_FEQ_pct_change = 100 * (trayvon_post_FEQ - trayvon_control_post_FEQ) / trayvon_control_post_FEQ
trayvon_post_NEQ_pct_change = 100 * (trayvon_post_NEQ - trayvon_control_post_NEQ) / trayvon_control_post_NEQ
trayvon_post_PEQ_pct_change = 100 * (trayvon_post_PEQ - trayvon_control_post_PEQ) / trayvon_control_post_PEQ
trayvon_post_PQ_pct_change = 100 * (trayvon_post_PQ - trayvon_control_post_PQ) / trayvon_control_post_PQ

uvalde_post_AEQ_pct_change = 100 * (uvalde_post_AEQ - uvalde_control_post_AEQ) / uvalde_control_post_AEQ
uvalde_post_DEQ_pct_change = 100 * (uvalde_post_DEQ - uvalde_control_post_DEQ) / uvalde_control_post_DEQ
uvalde_post_FEQ_pct_change = 100 * (uvalde_post_FEQ - uvalde_control_post_FEQ) / uvalde_control_post_FEQ
uvalde_post_NEQ_pct_change = 100 * (uvalde_post_NEQ - uvalde_control_post_NEQ) / uvalde_control_post_NEQ
uvalde_post_PEQ_pct_change = 100 * (uvalde_post_PEQ - uvalde_control_post_PEQ) / uvalde_control_post_PEQ
uvalde_post_PQ_pct_change = 100 * (uvalde_post_PQ - uvalde_control_post_PQ) / uvalde_control_post_PQ
```

EQ and PQ Percent Change from Control Data visualization
```{r}
event = c("Michael Brown", "Charleston", "Christchurch", "Laguna", "Pittsburgh", "Sandy Hook", "Santa Fe", "Trayvon Martin", "Uvalde")
NEQ_individual_pct_change = c(brown_post_NEQ_pct_change, charleston_post_NEQ_pct_change, christchurch_post_NEQ_pct_change, laguna_post_NEQ_pct_change, pittsburgh_post_NEQ_pct_change, sandy_post_NEQ_pct_change, santafe_post_NEQ_pct_change, trayvon_post_NEQ_pct_change, uvalde_post_NEQ_pct_change)
data_df = data.frame(event, NEQ_individual_pct_change)
bargraph = ggplot(data_df, aes(event, NEQ_individual_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Negative Emotion Quotient Percent Change - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "NEQ Individual Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

FEQ_individual_pct_change = c(brown_post_FEQ_pct_change, charleston_post_FEQ_pct_change, christchurch_post_FEQ_pct_change, laguna_post_FEQ_pct_change, pittsburgh_post_FEQ_pct_change, sandy_post_FEQ_pct_change, santafe_post_FEQ_pct_change, trayvon_post_FEQ_pct_change, uvalde_post_FEQ_pct_change)
data_df = data.frame(event, FEQ_individual_pct_change)
bargraph = ggplot(data_df, aes(event, FEQ_individual_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Fear Emotion Quotient Percent Change - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "FEQ Individual Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

DEQ_individual_pct_change = c(brown_post_DEQ_pct_change, charleston_post_DEQ_pct_change, christchurch_post_DEQ_pct_change, laguna_post_DEQ_pct_change, pittsburgh_post_DEQ_pct_change, sandy_post_DEQ_pct_change, santafe_post_DEQ_pct_change, trayvon_post_DEQ_pct_change, uvalde_post_DEQ_pct_change)
data_df = data.frame(event, DEQ_individual_pct_change)
bargraph = ggplot(data_df, aes(event, DEQ_individual_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Disgust Emotion Quotient Percent Change - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "DEQ Individual Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

AEQ_individual_pct_change = c(brown_post_AEQ_pct_change, charleston_post_AEQ_pct_change, christchurch_post_AEQ_pct_change, laguna_post_AEQ_pct_change, pittsburgh_post_AEQ_pct_change, sandy_post_AEQ_pct_change, santafe_post_AEQ_pct_change, trayvon_post_AEQ_pct_change, uvalde_post_AEQ_pct_change)
data_df = data.frame(event, AEQ_individual_pct_change)
bargraph = ggplot(data_df, aes(event, AEQ_individual_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Anger Emotion Quotient Percent Change - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "AEQ Individual Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

PEQ_individual_pct_change = c(brown_post_PEQ_pct_change, charleston_post_PEQ_pct_change, christchurch_post_PEQ_pct_change, laguna_post_PEQ_pct_change, pittsburgh_post_PEQ_pct_change, sandy_post_PEQ_pct_change, santafe_post_PEQ_pct_change, trayvon_post_PEQ_pct_change, uvalde_post_PEQ_pct_change)
data_df = data.frame(event, PEQ_individual_pct_change)
bargraph = ggplot(data_df, aes(event, PEQ_individual_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Positive Emotion Quotient Percent Change - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "PEQ Individual Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

#group data

group = c("Race-Related", "School-Related", "Religion-Related")
NEQ_group_pct_change = c((brown_post_NEQ_pct_change * nrow(brown_control_post) + charleston_post_NEQ_pct_change * nrow(charleston_control_post) + trayvon_post_NEQ_pct_change * nrow(trayvon_control_post)) / (nrow(brown_control_post) + nrow(charleston_control_post) + nrow(trayvon_control_post)), (sandy_post_NEQ_pct_change * nrow(sandy_control_post) + uvalde_post_NEQ_pct_change * nrow(uvalde_control_post) + santafe_post_NEQ_pct_change * nrow(santafe_control_post)) / (nrow(sandy_control_post) + nrow(uvalde_control_post) + nrow(santafe_control_post)), (christchurch_post_NEQ_pct_change * nrow(christchurch_control_post) + laguna_post_NEQ_pct_change * nrow(laguna_control_post) + pittsburgh_post_NEQ_pct_change * nrow(pittsburgh_control_post)) / (nrow(christchurch_control_post)+ nrow(laguna_control_post) + nrow(pittsburgh_control_post)))
data_df = data.frame(group, NEQ_group_pct_change)
bargraph = ggplot(data_df, aes(group, NEQ_group_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Average Negative Emotion Quotient Percent Change - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "NEQ Group Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

FEQ_group_pct_change = c((brown_post_FEQ_pct_change * nrow(brown_control_post) + charleston_post_FEQ_pct_change * nrow(charleston_control_post) + trayvon_post_FEQ_pct_change * nrow(trayvon_control_post)) / (nrow(brown_control_post) + nrow(charleston_control_post) + nrow(trayvon_control_post)), (sandy_post_FEQ_pct_change * nrow(sandy_control_post) + uvalde_post_FEQ_pct_change * nrow(uvalde_control_post) + santafe_post_FEQ_pct_change * nrow(santafe_control_post)) / (nrow(sandy_control_post) + nrow(uvalde_control_post) + nrow(santafe_control_post)), (christchurch_post_FEQ_pct_change * nrow(christchurch_control_post) + laguna_post_FEQ_pct_change * nrow(laguna_control_post) + pittsburgh_post_FEQ_pct_change * nrow(pittsburgh_control_post)) / (nrow(christchurch_control_post)+ nrow(laguna_control_post) + nrow(pittsburgh_control_post)))
data_df = data.frame(group, FEQ_group_pct_change)
bargraph = ggplot(data_df, aes(group, FEQ_group_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Average Fear Emotion Quotient Percent Changet - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "FEQ Group Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

DEQ_group_pct_change = c((brown_post_DEQ_pct_change * nrow(brown_control_post) + charleston_post_DEQ_pct_change * nrow(charleston_control_post) + trayvon_post_DEQ_pct_change * nrow(trayvon_control_post)) / (nrow(brown_control_post) + nrow(charleston_control_post) + nrow(trayvon_control_post)), (sandy_post_DEQ_pct_change * nrow(sandy_control_post) + uvalde_post_DEQ_pct_change * nrow(uvalde_control_post) + santafe_post_DEQ_pct_change * nrow(santafe_control_post)) / (nrow(sandy_control_post) + nrow(uvalde_control_post) + nrow(santafe_control_post)), (christchurch_post_DEQ_pct_change * nrow(christchurch_control_post) + laguna_post_DEQ_pct_change * nrow(laguna_control_post) + pittsburgh_post_DEQ_pct_change * nrow(pittsburgh_control_post)) / (nrow(christchurch_control_post)+ nrow(laguna_control_post) + nrow(pittsburgh_control_post)))
data_df = data.frame(group, DEQ_group_pct_change)
bargraph = ggplot(data_df, aes(group, DEQ_group_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Average Disgust Emotion Quotient Percent Change - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "DEQ Group Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

AEQ_group_pct_change = c((brown_post_AEQ_pct_change * nrow(brown_control_post) + charleston_post_AEQ_pct_change * nrow(charleston_control_post) + trayvon_post_AEQ_pct_change * nrow(trayvon_control_post)) / (nrow(brown_control_post) + nrow(charleston_control_post) + nrow(trayvon_control_post)), (sandy_post_AEQ_pct_change * nrow(sandy_control_post) + uvalde_post_AEQ_pct_change * nrow(uvalde_control_post) + santafe_post_AEQ_pct_change * nrow(santafe_control_post)) / (nrow(sandy_control_post) + nrow(uvalde_control_post) + nrow(santafe_control_post)), (christchurch_post_AEQ_pct_change * nrow(christchurch_control_post) + laguna_post_AEQ_pct_change * nrow(laguna_control_post) + pittsburgh_post_AEQ_pct_change * nrow(pittsburgh_control_post)) / (nrow(christchurch_control_post)+ nrow(laguna_control_post) + nrow(pittsburgh_control_post)))
data_df = data.frame(group, AEQ_group_pct_change)
bargraph = ggplot(data_df, aes(group, AEQ_group_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Average Anger Emotion Quotient Percent Change - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "AEQ Group Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

PEQ_group_pct_change = c((brown_post_PEQ_pct_change * nrow(brown_control_post) + charleston_post_PEQ_pct_change * nrow(charleston_control_post) + trayvon_post_PEQ_pct_change * nrow(trayvon_control_post)) / (nrow(brown_control_post) + nrow(charleston_control_post) + nrow(trayvon_control_post)), (sandy_post_PEQ_pct_change * nrow(sandy_control_post) + uvalde_post_PEQ_pct_change * nrow(uvalde_control_post) + santafe_post_PEQ_pct_change * nrow(santafe_control_post)) / (nrow(sandy_control_post) + nrow(uvalde_control_post) + nrow(santafe_control_post)), (christchurch_post_PEQ_pct_change * nrow(christchurch_control_post) + laguna_post_PEQ_pct_change * nrow(laguna_control_post) + pittsburgh_post_PEQ_pct_change * nrow(pittsburgh_control_post)) / (nrow(christchurch_control_post)+ nrow(laguna_control_post) + nrow(pittsburgh_control_post)))
data_df = data.frame(group, PEQ_group_pct_change)
bargraph = ggplot(data_df, aes(group, PEQ_group_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Average Positive Emotion Quotient Percent Change - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "PEQ Group Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

#individual PQ data

event = c("Michael Brown", "Charleston", "Christchurch", "Laguna", "Pittsburgh", "Sandy Hook", "Santa Fe", "Trayvon Martin", "Uvalde")
PQ_individual_pct_change = c(brown_post_PQ_pct_change, charleston_post_PQ_pct_change, christchurch_post_PQ_pct_change, laguna_post_PQ_pct_change, pittsburgh_post_PQ_pct_change, sandy_post_PQ_pct_change, santafe_post_PQ_pct_change, trayvon_post_PQ_pct_change, uvalde_post_PQ_pct_change)
data_df = data.frame(event, PQ_individual_pct_change)
bargraph = ggplot(data_df, aes(event, PQ_individual_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Political Quotient Percent Change - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "PQ Individual Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


#group PQ data

group = c("Race-Related", "School-Related", "Religion-Related")
PQ_group_pct_change = c((brown_post_PQ_pct_change * nrow(brown_control_post) + charleston_post_PQ_pct_change * nrow(charleston_control_post) + trayvon_post_PQ_pct_change * nrow(trayvon_control_post)) / (nrow(brown_control_post) + nrow(charleston_control_post) + nrow(trayvon_control_post)), (sandy_post_PQ_pct_change * nrow(sandy_control_post) + uvalde_post_PQ_pct_change * nrow(uvalde_control_post) + santafe_post_PQ_pct_change * nrow(santafe_control_post)) / (nrow(sandy_control_post) + nrow(uvalde_control_post) + nrow(santafe_control_post)), (christchurch_post_PQ_pct_change * nrow(christchurch_control_post) + laguna_post_PQ_pct_change * nrow(laguna_control_post) + pittsburgh_post_PQ_pct_change * nrow(pittsburgh_control_post)) / (nrow(christchurch_control_post)+ nrow(laguna_control_post) + nrow(pittsburgh_control_post)))
data_df = data.frame(group, PQ_group_pct_change)
bargraph = ggplot(data_df, aes(group, PQ_group_pct_change)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Average Political Quotient Percent Change - Group") + theme(text = element_text(family = "Times New Roman")) + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "PQ Group Vs Control", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")
```




EQ and PQ Data visualization
```{r}
#individual EQ data

event = c("Michael Brown", "Charleston", "Christchurch", "Laguna", "Pittsburgh", "Sandy Hook", "Santa Fe", "Trayvon Martin", "Uvalde")
NEQ_individual = c(brown_post_NEQ, charleston_post_NEQ, christchurch_post_NEQ, laguna_post_NEQ, pittsburgh_post_NEQ, sandy_post_NEQ, santafe_post_NEQ, trayvon_post_NEQ, uvalde_post_NEQ)
data_df = data.frame(event, NEQ_individual)
bargraph = ggplot(data_df, aes(event, NEQ_individual)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Negative Emotion Quotient - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "NEQ Individual", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")

FEQ_individual = c(brown_post_FEQ, charleston_post_FEQ, christchurch_post_FEQ, laguna_post_FEQ, pittsburgh_post_FEQ, sandy_post_FEQ, santafe_post_FEQ, trayvon_post_FEQ, uvalde_post_FEQ)
data_df = data.frame(event, FEQ_individual)
bargraph = ggplot(data_df, aes(event, FEQ_individual)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Fear Emotion Quotient - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "FEQ Individual", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


DEQ_individual = c(brown_post_DEQ, charleston_post_DEQ, christchurch_post_DEQ, laguna_post_DEQ, pittsburgh_post_DEQ, sandy_post_DEQ, santafe_post_DEQ, trayvon_post_DEQ, uvalde_post_DEQ)
data_df = data.frame(event, DEQ_individual)
bargraph = ggplot(data_df, aes(event, DEQ_individual))+ geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Disgust Emotion Quotient - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph 
ggsave(filename = "DEQ Individual", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


AEQ_individual = c(brown_post_AEQ, charleston_post_AEQ, christchurch_post_AEQ, laguna_post_AEQ, pittsburgh_post_AEQ, sandy_post_AEQ, santafe_post_AEQ, trayvon_post_AEQ, uvalde_post_AEQ)
data_df = data.frame(event, AEQ_individual)
bargraph = ggplot(data_df, aes(event, AEQ_individual)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Anger Emotion Quotient - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "AEQ Individual", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


PEQ_individual = c(brown_post_PEQ, charleston_post_PEQ, christchurch_post_PEQ, laguna_post_PEQ, pittsburgh_post_PEQ, sandy_post_PEQ, santafe_post_PEQ, trayvon_post_PEQ, uvalde_post_PEQ)
data_df = data.frame(event, PEQ_individual)
bargraph = ggplot(data_df, aes(event, PEQ_individual))  + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Positive Emotion Quotient - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "PEQ Individual", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


#group EQ data

group = c("Race-Related", "School-Related", "Religion-Related")
NEQ_group = c((brown_post_NEQ  * nrow(brown_post) + charleston_post_NEQ  * nrow(charleston_post) + trayvon_post_NEQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_NEQ  * nrow(sandy_post) + uvalde_post_NEQ  * nrow(uvalde_post) + santafe_post_NEQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_NEQ  * nrow(christchurch_post) + laguna_post_NEQ  * nrow(laguna_post) + pittsburgh_post_NEQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))
data_df = data.frame(group, NEQ_group)
bargraph = ggplot(data_df, aes(group, NEQ_group)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Negative Emotion Quotient - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "NEQ Group", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


FEQ_group = c((brown_post_FEQ  * nrow(brown_post) + charleston_post_FEQ  * nrow(charleston_post) + trayvon_post_FEQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_FEQ  * nrow(sandy_post) + uvalde_post_FEQ  * nrow(uvalde_post) + santafe_post_FEQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_FEQ  * nrow(christchurch_post) + laguna_post_FEQ  * nrow(laguna_post) + pittsburgh_post_FEQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))
data_df = data.frame(group, FEQ_group)
bargraph = ggplot(data_df, aes(group, FEQ_group)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Fear Emotion Quotient - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "FEQ Group", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


DEQ_group = c((brown_post_DEQ  * nrow(brown_post) + charleston_post_DEQ  * nrow(charleston_post) + trayvon_post_DEQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_DEQ  * nrow(sandy_post) + uvalde_post_DEQ  * nrow(uvalde_post) + santafe_post_DEQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_DEQ  * nrow(christchurch_post) + laguna_post_DEQ  * nrow(laguna_post) + pittsburgh_post_DEQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))
data_df = data.frame(group, DEQ_group)
bargraph = ggplot(data_df, aes(group, DEQ_group))  + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Disgust Emotion Quotient - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "DEQ Group", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


AEQ_group = c((brown_post_AEQ  * nrow(brown_post) + charleston_post_AEQ  * nrow(charleston_post) + trayvon_post_AEQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_AEQ  * nrow(sandy_post) + uvalde_post_AEQ  * nrow(uvalde_post) + santafe_post_AEQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_AEQ  * nrow(christchurch_post) + laguna_post_AEQ  * nrow(laguna_post) + pittsburgh_post_AEQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))
data_df = data.frame(group, AEQ_group)
bargraph = ggplot(data_df, aes(group, AEQ_group)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Anger Emotion Quotient - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "AEQ Group", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


PEQ_group = c((brown_post_PEQ  * nrow(brown_post) + charleston_post_PEQ  * nrow(charleston_post) + trayvon_post_PEQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_PEQ  * nrow(sandy_post) + uvalde_post_PEQ  * nrow(uvalde_post) + santafe_post_PEQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_PEQ  * nrow(christchurch_post) + laguna_post_PEQ  * nrow(laguna_post) + pittsburgh_post_PEQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))
data_df = data.frame(group, PEQ_group)
bargraph = ggplot(data_df, aes(group, PEQ_group)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Positive Emotion Quotient - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "PEQ Group", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


#individual PQ data

event = c("Michael Brown", "Charleston", "Christchurch", "Laguna", "Pittsburgh", "Sandy Hook", "Santa Fe", "Trayvon Martin", "Uvalde")
PQ_individual = c(brown_post_PQ, charleston_post_PQ, christchurch_post_PQ, laguna_post_PQ, pittsburgh_post_PQ, sandy_post_PQ, santafe_post_PQ, trayvon_post_PQ, uvalde_post_PQ)
data_df = data.frame(event, PQ_individual)
bargraph = ggplot(data_df, aes(event, PQ_individual)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Political Quotient - Individual") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "PQ Individual", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


#group PQ data

group = c("Race-Related", "School-Related", "Religion-Related")
PQ_group = c((brown_post_PQ  * nrow(brown_post) + charleston_post_PQ  * nrow(charleston_post) + trayvon_post_PQ  * nrow(trayvon_post)) / (nrow(brown_post) + nrow(charleston_post) + nrow(trayvon_post)), (sandy_post_PQ  * nrow(sandy_post) + uvalde_post_PQ  * nrow(uvalde_post) + santafe_post_PQ  * nrow(santafe_post)) / (nrow(sandy_post) + nrow(uvalde_post) + nrow(santafe_post)), (christchurch_post_PQ  * nrow(christchurch_post) + laguna_post_PQ  * nrow(laguna_post) + pittsburgh_post_PQ  * nrow(pittsburgh_post)) / (nrow(christchurch_post)+ nrow(laguna_post) + nrow(pittsburgh_post)))
data_df = data.frame(group, PQ_group)
bargraph = ggplot(data_df, aes(group, PQ_group)) + geom_bar(stat="identity", width = 0.5, fill="deepskyblue4") + labs(title = "Political Quotient - Group") + theme(text = element_text(family = "Times New Roman"))
bargraph
ggsave(filename = "PQ Group", plot = bargraph, device = "png", path = "/Users/jeffreyedsall/Desktop/ProjectData/plots")


```


Exporting to CSV files: 

```{r}

#/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data...

#write.csv(brown_post, "/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data/brown_final.csv" )

#write.csv(brown_post, "/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data/brown_final.csv" )

#write.csv(charleston_post, "/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data/charleston_final.csv" )

#write.csv(christchurch_post, "/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data/christchurch_final.csv" )

#write.csv(laguna_post, "/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data/laguna_final.csv" )

#write.csv(pittsburgh_post, "/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data/pittsburgh_final.csv" )

#write.csv(sandy_post, "/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data/sandy_final.csv" )

#write.csv(santafe_post, "/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data/santafe_final.csv" )

#write.csv(trayvon_post, "/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data/trayvon_final.csv" )

#write.csv(uvalde_post, "/Users/garyschmidt/Desktop/Econ151PrelimData/Processed Data/uvalde_final.csv" )

```






